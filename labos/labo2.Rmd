---
title: "T.P. Variables aléatoires et inférence statistique (Labo 2)"
author: "Marc-André Désautels"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: no
    latex_engine: pdflatex
  html_document:
    toc: yes
    toc_float: yes
subtitle: "201-9F6-ST : Statistiques appliquées à l'informatique"
institute: "Cégep Saint-Jean-sur-Richelieu"
urlcolor: blue
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

# Instructions:

1. Le but de ce T. P. est de vous familiariser avec le langage `R`. Il vous faudra trouver et utiliser les commandes appropriées
pour répondre aux questions. Vous devez vous aider de la documentation fournie dans le logiciel `RStudio` ou de la recherche `Google`.
2. Vous devez répondre aux questions directement dans ce document et vous assurez qu'il compile lorsque vous utilisez la commande `Knit`. Vous pouvez également compiler vos commandes au fur et à mesure dans ce document en appuyant sur la **flèche verte pointant vers la droite** en haut à droite de votre code `R`.

# Installer `R` et `RStudio`

Vous pouvez télécharger `R` aux adresses suivantes:

- Pour [Linux](http://cran.utstat.utoronto.ca/bin/linux/)
- Pour [(Mac) OS X](http://cran.utstat.utoronto.ca/bin/macosx/)
- Pour [Windows](http://cran.utstat.utoronto.ca/bin/windows/)

Une fois le logiciel `R` installé, vous pouvez télécharger et installer le logiciel `RStudio` à l'adresse suivante:

- Pour [Linux, (Mac) OS X et Windows](https://www.rstudio.com/products/rstudio/download/)

# Les lois de probabilités

Chaque distribution en `R` possède quatre fonctions qui lui sont associées. Premièrement, la fonction possède un _nom racine_ (qui correspond au nom de la `loi`), par exemple le _nom racine_ pour la distribution *binomiale* est `binom`. Cette racine est précédée par une de ces quatre lettre:

- `p` pour *probabilité*, qui représente la fonction de répartition
- `q` pour *quantile*, l'inverse de la fonction de répartition
- `d` pour *densité*, la fonction de densité de la distribution
- `r` pour *random* ou *simulation*, une variable aléatoire suivant la distribution spécifiée.

Pour la loi binomiale (_nom racine_ `binom`) par exemple, ces fonctions sont `pbinom`, `qbinom`, `dbinom` et `rbinom`.

Nous avons donc:

|Loi: `loi`|Densité|Fonction de répartition|Quantile|Simulation|
|:--------:|:-----:|:---------------------:|:------:|:--------:|
|Notations|$f(x)$ ou $P(X=x)$|$F(x)$|valeur liée à $F(x)$|$x_1$, $x_2$, ..., $x_n$|
|Commandes|`dloi`|`ploi`|`qloi`|`rloi`|

Les noms de lois les plus célèbres sont : `norm` (pour la loi normale), `norm` (pour la loi binomiale), `unif` (pour la loi uniforme), `geom` (pour la loi géométrique), `pois` (pour la loi de Poisson), `t` (pour la loi de Student), `chisq` (pour la loi du Chi-deux), `exp` (pour la loi exponentielle), `f` (pour la loi de Fisher)...

# Commandes

Si la loi de $X$ dépend d’un ou de plusieurs paramètres, disons `par1` et `par2`, alors la densité de $X$ en $x$ est donnée par la commande : `dloi(x, par1, par2)`

Quelques exemples sont décrits ci-dessous:

|Loi|Binomiale|Géométrique|Poisson|
|:---:|:-----:|:--------:|:------:|
|Paramètres|$n\in\mathbb{N}$, $p\in]0,1[$|$p\in]0,1[$|$\lambda>0$|
|$X\sim$|$B(n;p)$|$G(p)$|$Po(\lambda)$|
|Ch($X$)|$\left\{0,1,\ldots,n\right\}$|$\mathbb{N}$|$\mathbb{N}$|
|$P(X=x)$|$C_x^np^xq^{n-x}$|$p(1-p)^x$|$e^{-\lambda}\frac{\lambda^x}{x!}$|
|Commandes|`dbinom(x,n,p)`|`dgeom(x,p)`|`dpois(x,lambda)`|

test

|Loi|Uniforme|Exponentielle|Normale|
|:---:|:-----:|:--------:|:------:|
|Paramètres|$(a,b)\in\mathbb{R}^2,a<b$|$p\in]0,1[$|$\lambda>0$|
<!-- |Paramètres|$(a,b)\in\mathbb{R}^2,a<b$|$\lambda>0$|$\mu\in\mathbb{R},\sigma>0$| -->
<!-- |$X\sim$ | $U([a,b])$ | $E(\lambda)$ | $N(\mu,\sigma^2)$ | -->
<!-- |Ch($X$) | $[a,b]$ | $[0,\infty]$ | $\mathbb{R}$ | -->
<!-- |$P(X=x)$ | $\frac{1}{b-a}$ | $\lambda^{-\lambda x}$ | $\frac{1}{\sqrt{2\pi \sigma^2}}e^{\tfrac{-(x-\mu)^2}{2\sigma^2}}$ | -->
<!-- |Commandes | `dunif(x,a,b)` | `dexp(x,lambda)` | `dnorm(x,mu,sigma)` | -->

## Exemples de calculs

Soit $X$ une variable aléatoire telle que $X\sim B(8,0.3)$.

1. Pour calculer $P(X=4)$, nous devons utiliser la commande suivante:
```{r}
dbinom(4,8,0.3)
```
Ceci signifie que $P(X=4)=`r dbinom(4,8,0.3)`$.

2. Pour calculer $P(X\leq 4)$, nous devons utiliser la commande suivante:
```{r}
pbinom(4,8,0.3)
```
Ceci signifie que $P(X\leq 4)=`r pbinom(4,8,0.3)`$.

3. Pour calculer $P(X> 4)$, nous pouvons utiliser une des commandes suivantes:
```{r}
pbinom(4,8,0.3,lower.tail = FALSE)
1-pbinom(4,8,0.3)
```
Ceci signifie que $P(X>4)=`r 1-pbinom(4,8,0.3)`$.

4. Pour calculer $P(X\geq 4)=1-P(X\leq 3)$, nous pouvons utiliser la commande suivante:
```{r}
1-pbinom(3,8,0.3)
```
Ceci signifie que $P(X\geq 4)=`r 1-pbinom(3,8,0.3)`$.

# Représentation graphique

## Les lois de probabilités discrètes

Nous pouvons représenter graphiquement la loi binomiale. Soit $X~B(8,0.3)$. Nous aurons:

```{r}
n <- 8
p <- 0.3
fbinom <- data.frame(x = 0:n, y = dbinom(0:n, n, p))
ggplot(fbinom, aes(x = x, y = y)) +
  geom_bar(width = 0.05, stat = "identity") +
  labs(
    x = "Nombre de succès",
    y = "Probabilité",
    title = "Fonction de densité de B(8,0.3)"
  )
```

## Les lois de probabilités continues

Nous pouvons représenter graphiquement la loi normale. Soit $X\sim N(5,1.5^2)$. Nous aurons:

```{r}
ggplot(data = data.frame(x = c(0, 10)), aes(x)) +
  stat_function(fun = dnorm, args = list(mean = 5, sd = 1.5)) +
  labs(
    x = "x",
    y = "f(x)",
    title = "Fonction de densité de N(5,1.5^2)"
  )
```

```{r}
ggplot(data = data.frame(x = c(-5, 20)), aes(x)) +
  stat_function(fun = dnorm, args = list(mean = 10, sd = 3)) +
  stat_function(fun = dnorm, args = list(mean = 8, sd = 5)) +
  labs(
    x = "x",
    y = "f(x)",
    title = ""
  )
```
